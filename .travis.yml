sudo: false
language: java
jdk:
  - openjdk7

script: mvn test

after_success:
  - bash <(curl -s https://codecov.io/bash)
  - echo ${OSSRH_USER}

before_deploy:
  - echo "<settings><servers><server><id>bintray</id><username>\${OSSRH_USER}</username><password>\${OSSRH_PASS}</password></server></servers></settings>" > ~/settings.xml
  - mvn deploy --settings ~/settings.xml
  - bash .utility/deploy-javadoc.sh
  - bash .utility/check-dependencies.sh
  - VERSION=`ls target/PvpTitles-*.jar | sed 's/target\/PvpTitles-//;s/.jar//;'`
  - cp target/PvpTitles-$VERSION.jar target/PvpTitles.jar

deploy:
  provider: releases
  api_key:
    secure: d/tIg31Tg6CmOBrqPqf+kh6f9Q/QL06ABeLIxfMe9KozIEjDdHyGzB6TNIxPSp1IbF2V5+0KtY8G2RcA0MfXru0350R3aE5OZlde9Viptu91Tbsg7po63LQmgpIoHtgtOuRUsJzamEkVfcULQKyH7zo+FqlMGYxkOdmQMrTNnDWkuomfITqIjeNqFOiyS7VuoJm1dYS5r9qeEGbOfu8RNRd0s/jvUtbQuG1IvE50qkWPYvB7Gq+vFeIKI9jWvyWKmA+Ru+JzKdydmsKEY586/nGiuY+Kc+2v+OJtsP8G2zAIy7gepSq1YQbNbULataeKaj6MxJTPgNyW4ZFg/ZWCFpMDnLvBzNrBE/HIV5YgtI4A6AWLMjDXJtD5U3Z/Q6E1gRpJUo1e9yjdfmUJHluXBKy1QmevEnsJoBFWpCdAAmd01UOZL3NsLZxZ8ZmRDPnH2EriJ/yw0H1VLQOoB3uSNsSdrMO5ijvy5UPn+fxr6eAlbL1fcE0imOybxF3cPf3zpg+wbv3vOhrzXrBQyVhWDnPleIL+Rak8ekfrlqlYBRmqax6SAC8DZ24P5D7YihtO8J5HdkKSCJetmnHtk/5K9O3GGzW3VW9EZYofKGPswIGqpl8ANw1vJOqVz1soiDM9VEQ4MIg+7T65HfPnvttnykilVcwnmLI0cUme2CmAZUU=
  file: target/PvpTitles.jar
  on:
    tags: true
 
notifications:
  email: false
  irc:
    channels:
    - "irc://freenode/pvptitles"
    use_notice: true
    skip_join: true

env:    
  global:
  - secure: BULEaHVVB9kRmrVR46Xz8LpzLpFMHlDvsiDx0Lr+y6c2QSHRehXIdNEizsgWxIyhH4BRGPbN978i12daPzEf613gJNywHyrxiF7nc3yMs18rca6Z1yApP7ANejit3VGw0E9GrdP+58o10hNt3mB7pt2u7oXBBTaOOGARGrCX2rPbtNAkrWKKo9ytNr6Ymkn2lRtxvNYRI/8mmyFxPSNbZ9dUBTSHy2wHH+FvXpyF+yhrknEJZrR9AadaPSFRXavY6ialuhCt8sHA97k/Wn/XEDZhzNLRktJVCGazuel6J1miD7igK8CRKhox/SBj7j+4dodew2uVzcBm2htH57T6R7x5/12Jo0JE1jNddtAgACyWyIqFOd+ihUuE4YCOABbbF90qZrS2sYiyiVj11jtEj8yklRPDTvIN8Zn+qMdwqJzedJk0zbW48utDSWO2fRDHEMjgxHhKT0df3CPImL+7Bd61iEgC6iHalcsZ9j9XXLDqHShSfmBuio1pqFS6BUIcMsFZtq1wsIi6jPOA0PvuwXx9VEdu/D2ONLAslbMvBK/TLvmVrjTHGxLOy1URLttGnVBID+PflIRxAI4euG36xH1BE1AErk6A34o2vr33SU5JlsaWzxVjMgcK1nBz98AbfGz4d53oeueE1HHjFH5NQhuajDoJgRpj4acxwfFPHTk=